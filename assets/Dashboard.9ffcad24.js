var ae=Object.defineProperty,ne=Object.defineProperties;var le=Object.getOwnPropertyDescriptors;var R=Object.getOwnPropertySymbols;var V=Object.prototype.hasOwnProperty,D=Object.prototype.propertyIsEnumerable;var J=(r,c,n)=>c in r?ae(r,c,{enumerable:!0,configurable:!0,writable:!0,value:n}):r[c]=n,m=(r,c)=>{for(var n in c||(c={}))V.call(c,n)&&J(r,n,c[n]);if(R)for(var n of R(c))D.call(c,n)&&J(r,n,c[n]);return r},N=(r,c)=>ne(r,le(c));var j=(r,c)=>{var n={};for(var l in r)V.call(r,l)&&c.indexOf(l)<0&&(n[l]=r[l]);if(r!=null&&R)for(var l of R(r))c.indexOf(l)<0&&D.call(r,l)&&(n[l]=r[l]);return n};import{R as e,e as re,S as ce,f as oe,L as B}from"./vendor.32ae6308.js";import{B as h,e as g,S as se,d as L,M as Q,q as H,h as K,r as S}from"./index.25888adf.js";import{b as me}from"./blobToBase64.b0516286.js";const z=r=>{const{onChange:c,label:n,name:l,type:u,origin:C,defaultValue:b}=r,f=e.useRef(null),[w,p]=e.useState({name:"",base64:""});e.useEffect(()=>{b&&p({name:"file.name",base64:C+"/"+b})},[]);function k(y){const v=y.target.files[0];me(v,U=>{p({name:v.name,base64:U}),c&&c({target:{name:l,type:u,file:v,fileName:v.name}})})}function d(y){f.current.click()}return e.createElement("div",{className:"input-group"},e.createElement("input",{name:l,ref:f,type:"file",className:"hide-input-image",onChange:k}),e.createElement("div",{className:"preview_image"},e.createElement("label",null,w.name),e.createElement("img",{src:w.base64,alt:"preview image"})),n&&e.createElement("label",{htmlFor:l},n),e.createElement(h,{className:"file_upload_button",onClick:d},"Choose Image",e.createElement("i",{className:"far fa-cloud"})))},{TabPane:W}=H,de=r=>{const[c,n]=e.useState(),[l,u]=e.useState([]),[C,b]=e.useState([]),[f,w]=e.useState([]),[p,k]=e.useState(""),[d,y]=e.useState([]),[v,U]=e.useState(!1);e.useEffect(()=>{(async function(){const t=await g.get("/api/products/count");n(t.data.count);const{data:o}=await g.get("/api/products/?_for=admin");u(o.products);const E=await g.get("/api/categories/?type=lastLevel");b(E.data.categories);const _=await g.get("/api/brands");w(_.data.brands)})()},[]);const[i,I]=e.useState({}),[F,x]=e.useState({});function $(t){k("update");let o=m({},i);for(let E=0;E<P.length;E++)t[P[E].name]&&(o[P[E].name]=t[P[E].name]);I(o),x(t)}const P=[{name:"title",type:"input",label:"Product Name",required:!0},{name:"cover_photo",type:"file",label:"Product Cover Photo",required:!0},{name:"price",type:"input",label:"Product Unit Price",required:!0},{name:"qty",type:"input",label:"Product Quantity",require:!0},{name:"category_id",type:"select",label:"Select a category",require:!0,values:C,valueKey:{name:"name",id:"_id"}},{name:"brand_id",type:"select",label:"Select a Brand",require:!0,values:f,valueKey:{name:"name",id:"_id"}}];function A(t){I(N(m({},i),{[t.target.name]:t.target.value}))}function q(t){g.delete(`/api/products/${t}`).then(o=>{alert(JSON.stringify(o.data))}),u(l.filter(o=>o._id!==t))}async function M(){let t=[...l];if(p==="new"){let E=N(m({},i),{sold:0,views:0}),O=(await g.post("/api/products",m({},E))).data;u([O])}else if(p==="update"){const o=m(m({},F),i),{brand:_,category:O,_id:ge}=o,Y=j(o,["brand","category","_id"]);let{data:Z}=await g.put(`/api/products/${F._id}`,m({},Y)),ee=t.findIndex(te=>te._id===F._id);t[ee]=Z.product,u(t)}}function T(t){t.target.type==="file"?I(N(m({},i),{[t.target.name]:t.target.file,fileName:t.target.fileName})):I(N(m({},i),{[t.target.name]:t.target.value}))}function a(){function t(o){}return e.createElement(Q,null,e.createElement(H,{defaultActiveKey:"1",onChange:t},e.createElement(W,{tab:"Upload a new image",key:"1"},e.createElement(K,{name:"logo",label:"Logo image cdn link",onChange:T}),e.createElement("span",null,"or"),e.createElement(z,{type:"file",name:"logo",onChange:T,label:"Choose a photo"})),e.createElement(W,{tab:"Images Gallery",key:"2"},e.createElement("div",{className:"d-flex"},d.map(o=>e.createElement("div",{className:"static-image-thumbs"},e.createElement("img",{src:L(o)})))))),e.createElement(h,null,"Save"))}function s(){return e.createElement("div",null,e.createElement("h2",null,p==="new"?"Add New Product":"Update Product"),P&&P.map(t=>e.createElement("div",{className:""},t.type&&t.type==="select"?e.createElement(se,{defaultValue:i[t.name],name:t.name,onChange:A},e.createElement("option",{value:""},t.label),t.values&&t.values.map(o=>e.createElement("option",{value:o[t.valueKey.id]},o[t.valueKey.name]))):t.type&&t.type==="file"?e.createElement("div",null,e.createElement("img",{src:L(t.cover_photo),alt:t.cover_photo}),e.createElement(h,{onClick:()=>U(!v)},"Upgrade Cover Photo"),v&&a()):e.createElement(e.Fragment,null,e.createElement(K,{label:t.label,name:t.name,value:i[t.name],onChange:A})))),e.createElement(h,{onClick:M},p==="new"?"Save Product":"Update Product"))}return e.createElement("div",{className:"container"},p===""?e.createElement(h,{onClick:t=>k("new")},"Add New Product"):e.createElement(h,{onClick:t=>k("")},"Cancel"),p!==""&&s(),e.createElement("h3",null,"Products fetch ",l.length," of ",c," "),e.createElement("table",null,e.createElement("thead",null,e.createElement("tr",null,e.createElement("th",{className:"t-start"},"Image"),e.createElement("th",{className:"t-center"},"Title"),e.createElement("th",null,"Added"),e.createElement("th",null,"Category"),e.createElement("th",null,"Brand"),e.createElement("th",null,"Price"),e.createElement("th",null,"Stock"),e.createElement("th",null,"Sold"),e.createElement("th",null,"Action"))),e.createElement("tbody",null,l.map(t=>e.createElement("tr",null,e.createElement("td",{className:""},t.logo&&e.createElement("div",{className:"brand_logo"},e.createElement("img",{src:L(t.logo)}))),e.createElement("td",{className:"t-center"},t.title),e.createElement("td",{className:"t-center"},new Date(Number(t.created_at)).toDateString()),e.createElement("td",{className:"t-center"},t.category&&t.category.name),e.createElement("td",{className:"t-center"},t.brand&&t.brand.name),e.createElement("td",{className:"t-center"},"$",t.price),e.createElement("td",{className:"t-center"},t.qty),e.createElement("td",{className:"t-center"},t.sold),e.createElement("td",{className:"t-center d-flex"},e.createElement("button",null,e.createElement("i",{className:"fal fa-pen",onClick:o=>$(t)})),e.createElement("button",null,e.createElement("i",{onClick:()=>q(t._id),className:"fal fa-trash"}))))))))},ie=r=>null,{TabPane:X}=H,ue=r=>{const[c,n]=e.useState(0),[l,u]=e.useState([]),[C,b]=e.useState([]),[f,w]=e.useState(""),[p,k]=e.useState(!1),[d,y]=e.useState({name:"",logo:""}),[v,U]=e.useState({}),i=[{name:"name",label:"Brand Name",required:!0},{name:"logo",type:"image",fileName:"",label:"Brand Logo",required:!1}];e.useEffect(()=>{(async function(){const{data:a}=await g.get("/api/brands/count");n(a.count);const s=await g.get("/api/brands");u(s.data.brands)})()},[]);function I(a){w("update");let s=m({},d);for(let t=0;t<i.length;t++)a[i[t].name]&&(s[i[t].name]=a[i[t].name]);y(s),U(a)}function F(a){g.delete(`/api/brands/${a}`).then(s=>{u(l.filter(t=>t._id!==a))})}function x(a){a.target.type==="image"?y(N(m({},d),{[a.target.name]:a.target.file,fileName:a.target.fileName})):y(N(m({},d),{[a.target.name]:a.target.value}))}async function $(){if(f==="new"){if(d.logo){let s=new FormData;for(const o in d)s.append(o,d[o]);let{data:t}=await g.post("/api/brands/with-image-upload",s);u([...l,...t.brands])}}else{[...l];let a=v,{_id:s}=a,t=j(a,["_id"]),o=new FormData,E=m(m({},t),d);for(let _ in E)_!=="fileName"&&o.append(_,E[_]);await g.put(`/api/brands/${s}`,o)}}function P(){g.get("/api/static-file").then(a=>{b(a.data)})}function A(a){y(N(m({},d),{logo:"upload/"+a}))}function q(a){a.target.type==="file"?y(N(m({},d),{[a.target.name]:a.target.file,fileName:a.target.fileName})):y(N(m({},d),{[a.target.name]:a.target.value}))}function M(){function a(s){s==="2"&&P()}return e.createElement(Q,null,e.createElement(H,{defaultActiveKey:"1",onChange:a},e.createElement(X,{tab:"Upload a new image",key:"1"},e.createElement(K,{name:"logo",label:"Logo image cdn link",onChange:q}),e.createElement("span",null,"or"),e.createElement(z,{type:"file",name:"logo",onChange:q,label:"Choose a photo"})),e.createElement(X,{tab:"Images Gallery",key:"2"},e.createElement("div",{className:"d-flex"},C.map(s=>e.createElement("div",{className:"static-image-thumbs"},e.createElement("img",{onClick:()=>A(s),src:L(s)})))))),e.createElement(h,{onClick:()=>k(!1)},"Cancel"),e.createElement(h,null,"Save"))}function T(){return e.createElement("div",null,e.createElement("h2",null,f==="new"?"Add New Brand":"Update Brand"),i&&i.map(a=>e.createElement("div",{className:"form-control"},a.type==="image"?e.createElement("div",null,e.createElement(h,{onClick:()=>k(!p)},"Upgrade Logo"),p&&M()):e.createElement(K,{name:a.name,label:a.label,value:d[a.name],onChange:x}))),e.createElement(h,{onClick:$},f==="new"?"Save Brand":"Update Brand"))}return e.createElement("div",{className:"container"},f===""?e.createElement(h,{onClick:a=>w("new")},"Add New Brand"):e.createElement(h,{onClick:a=>w("")},"Cancel"),f!==""&&T(),e.createElement("h3",null,"Brands fetch ",l.length," of ",c," "),e.createElement("table",null,e.createElement("thead",null,e.createElement("tr",null,e.createElement("th",{className:"t-start"},"Logo"),e.createElement("th",{className:"t-start"},"Name"),e.createElement("th",null,"Added"),e.createElement("th",null,"Updated"),e.createElement("th",null,"Action"))),e.createElement("tbody",null,l.map(a=>e.createElement("tr",{key:a._id},e.createElement("td",{className:""},a.logo&&e.createElement("div",{className:"brand_logo"},e.createElement("img",{src:L(a.logo)}))),e.createElement("td",{className:""},a.name),e.createElement("td",{className:"t-center"},new Date(Number(a.created_at)).toDateString()),e.createElement("td",{className:"t-center"},new Date(Number(a.updated_at)).toDateString()),e.createElement("td",{className:"t-center"},e.createElement("button",{onClick:s=>I(a)},e.createElement("i",{className:"fal fa-pen"})),e.createElement("button",{onClick:()=>F(a._id)},e.createElement("i",{className:"fal fa-trash"}))))))))};const{SubMenu:G}=S,Ee=r=>{const{pathname:c,baseURL:n}=r;let[l,u]=e.useState([""]);function C(b){u([b])}return e.createElement("div",{className:"dashboard_sidebar"},e.createElement(S,{onClick:C,selectedKeys:["mail"],defaultOpenKeys:l},e.createElement(G,{key:"sub1",title:e.createElement("span",null,e.createElement("i",{className:"fa fa-heart"}),e.createElement("span",null,"Products"))},e.createElement(S.Item,{key:"1"},e.createElement(B,{to:n+"/products"},"Products")),e.createElement(S.Item,{key:"2"},e.createElement(B,{to:n+"/products"},"Add Products"))),e.createElement(G,{key:"sub2",title:e.createElement("span",null,e.createElement("i",{className:"fa fa-heart"}),e.createElement("span",null,"Categories"))},e.createElement(S.Item,{key:"2"},e.createElement(B,{to:n+"/categories"},"Categories")),e.createElement(S.Item,{key:"3"},e.createElement(B,{to:n+"/categories"},"Add New Categories"))),e.createElement(G,{key:"sub3",title:e.createElement("span",null,e.createElement("i",{className:"fa fa-heart"}),e.createElement("span",null,"Brands"))},e.createElement(S.Item,{key:"1"},e.createElement(B,{to:n+"/brands"},"Brands")),e.createElement(S.Item,{key:"2"},e.createElement(B,{to:n+"/brands"},"Add Brands"))),e.createElement(S.Item,{key:"324",icon:"fa fa-map-marker-alt"},e.createElement(B,{to:"/customer/guest"},"Customer Dashboard"))))},ye=r=>{const n=re().location.pathname,l="/auth/admin/dashboard";function u(){const C=[{path:"/products",component:de},{path:"/categories",component:ie},{path:"/brands",component:ue}];return e.createElement(ce,null,C.map((b,f)=>e.createElement(oe,{key:f,path:l+b.path,component:b.component})))}return e.createElement("div",null,e.createElement("div",{className:"sidebar-row"},e.createElement(Ee,{baseURL:l,pathname:n}),e.createElement("div",{className:"dashboard_content"},u())))};export{ye as default};
