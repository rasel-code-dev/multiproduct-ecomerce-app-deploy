var Z=Object.defineProperty,ee=Object.defineProperties;var te=Object.getOwnPropertyDescriptors;var F=Object.getOwnPropertySymbols;var ae=Object.prototype.hasOwnProperty,le=Object.prototype.propertyIsEnumerable;var j=(c,i,p)=>i in c?Z(c,i,{enumerable:!0,configurable:!0,writable:!0,value:p}):c[i]=p,N=(c,i)=>{for(var p in i||(i={}))ae.call(i,p)&&j(c,p,i[p]);if(F)for(var p of F(i))le.call(i,p)&&j(c,p,i[p]);return c},x=(c,i)=>ee(c,te(i));import{R as e,d as O,e as B,u as H,L as $}from"./vendor.32ae6308.js";import{H as y,t as ne,k as re,A as w,e as G,C as ie,J as se,d as ce,u as oe,o as ue}from"./index.77d03647.js";import{q as Y}from"./index.2116ed73.js";import{F as me}from"./FilterSidebar.ddf7c518.js";import{n as de}from"./index.701e0ca0.js";import{c as fe}from"./calculateDiscount.13bb0f81.js";import{S as ve}from"./Spin.3b3891b1.js";import{P as _e}from"./Pagination.66571ee9.js";const pe=c=>{const{title:i}=c;return e.createElement("div",null,e.createElement("h1",null,i))};const Ee=c=>{const i=B(),p=H(),{selectedCatSections:n,lastSelectedCategory:v,ui_filterItems:S}=c;function m(t,a,f=!1){typeof f!="boolean"&&p({type:"SET_LAST_SELECTED_CATEGORY",payload:{name:f.name,id:f.id,_id:f._id,_ids:f._ids}});let d=N({},n);if(t==="twoLevel"?d[t]?(d[t]=null,d.threeLevel=null,d.fourLevel=null,d.fiveLevel=null):d[t]=a:t==="threeLevel"?d[t]?(d[t]=null,d.fourLevel=null,d.fiveLevel=null):d[t]=a:t==="fourLevel"?d[t]?(d[t]=null,d.fiveLevel=null):d[t]=a:d[t]?d[t]=null:d[t]=a,p({type:"SET_SELECTED_CATEGORY_SECTIONS",payload:d}),typeof f!="boolean"&&f&&d.oneLevel){let E=`/p?cat=${d.oneLevel.id}`;f.id&&(E=E+`&cat_tree=${f.id}`),i.replace(E)}}return e.createElement("div",{className:"filter_section"},e.createElement("div",{className:"filter_section--each_section"},e.createElement("h4",{className:"filter_section__title"},"Categories".toUpperCase()),n.oneLevel&&e.createElement(e.Fragment,null,e.createElement("h4",{className:["menu-item",v&&v.id===n.oneLevel.id?"active-current__cat":""].join(" "),onClick:()=>m("twoLevel",{},n.oneLevel)},e.createElement("i",{className:"fa fa-chevron-right"}),e.createElement("span",null,n.oneLevel.name)),!n.twoLevel&&e.createElement("div",{className:"two-level-cat"},n.oneLevel.sub_menu.map(t=>e.createElement("li",{className:"menu-item",onClick:()=>m("twoLevel",t,t)},e.createElement("i",{className:"fa fa-chevron-right"}),e.createElement("span",null,t.name))))),n.twoLevel&&n.twoLevel.name&&e.createElement(e.Fragment,null,e.createElement("h4",{className:["two-level-cat menu-item",v&&v.id===n.twoLevel.id?"active-current__cat":""].join(" "),onClick:()=>m("threeLevel",{},n.twoLevel)},n.twoLevel.sub_menu&&e.createElement("i",{className:"fa fa-chevron-right"}),e.createElement("span",null,n.twoLevel.name)),!n.threeLevel&&e.createElement("div",{className:"three-level-cat"},n.twoLevel.sub_menu&&n.twoLevel.sub_menu.map(t=>e.createElement("li",{className:"menu-item",onClick:()=>m("threeLevel",t,t)},e.createElement("i",{className:"fa fa-chevron-right"}),e.createElement("span",null,t.name))))),n.threeLevel&&n.threeLevel.name&&e.createElement(e.Fragment,null,e.createElement("h4",{className:["three-level-cat menu-item",v&&v.id===n.threeLevel.id?"active-current__cat":""].join(" "),onClick:()=>m("fourLevel",n.fourLevel,n.threeLevel)},n.threeLevel.sub_menu&&e.createElement("i",{className:"fa fa-chevron-right"}),e.createElement("span",null,n.threeLevel.name)),!n.fourLevel&&e.createElement("div",{className:"four-level-cat"},n.threeLevel.sub_menu&&n.threeLevel.sub_menu.map(t=>e.createElement("li",{className:"menu-item",onClick:()=>m("fourLevel",t,t)},e.createElement("i",{className:"fa fa-chevron-right"}),e.createElement("span",null,t.name))))),n.fourLevel&&e.createElement(e.Fragment,null,e.createElement("h4",{className:["four-level-cat menu-item",v&&v.id===n.fourLevel.id?"active-current__cat":""].join(" "),onClick:()=>m("fiveLevel",{},n.fourLevel)},n.fourLevel.sub_menu&&e.createElement("i",{className:"fa fa-chevron-right"}),e.createElement("span",null,n.fourLevel.name)),!n.fiveLevel&&e.createElement("div",{className:"five-level-cat"},n.fourLevel.sub_menu&&n.fourLevel.sub_menu.map(t=>e.createElement("li",{className:"menu-item",onClick:()=>m("fiveLevel",t,t)},e.createElement("i",{className:"fa fa-chevron-right"}),e.createElement("span",null,t.name))))),n.fiveLevel&&e.createElement(e.Fragment,null,e.createElement("h4",{className:["five-level-cat menu-item",v&&v.id===n.fiveLevel.id?"active-current__cat":""].join(" ")},n.fiveLevel.name&&e.createElement("i",{className:"fa fa-chevron-right"}),e.createElement("span",null,n.fiveLevel.name)))))};function ge(c){return{lastSelectedCategory:c.productState.lastSelectedCategory,selectedCatSections:c.productState.selectedCatSections}}var he=O(ge,{})(Ee);const Le=c=>{const{selectedCatSections:i,lastSelectedCategory:p,dispatch:n,history:v}=c;function S(m,t){let a=N({},i);if(m&&n({type:"SET_LAST_SELECTED_CATEGORY",payload:{name:m.name,id:m.id,_id:m._id,_ids:m._ids}}),t==="oneLevel"?(a.twoLevel=null,a.threeLevel=null,a.fourLevel=null,a.fiveLevel=null):t==="twoLevel"?a[t]?(a[t]=null,a.threeLevel=null,a.fourLevel=null,a.fiveLevel=null):a[t]=m:t==="threeLevel"?a[t]?(a[t]=null,a.fourLevel=null,a.fiveLevel=null):a[t]=m:t==="fourLevel"?a[t]?(a[t]=null,a.fiveLevel=null):a[t]=m:a[t]?a[t]=null:a[t]=m,n({type:"SET_SELECTED_CATEGORY_SECTIONS",payload:a}),m&&a.oneLevel){let f=`/p?cat=${a.oneLevel.id}`;m.id&&(f=f+`&cat_tree=${m.id}`),v.replace(f)}}return e.createElement("div",{className:"mt-2"},e.createElement(y,null,i.oneLevel&&e.createElement(y.Item,{onClick:()=>S(i.oneLevel,"oneLevel")},e.createElement("i",{className:"far fa-home"}),i.oneLevel.name),i.twoLevel&&e.createElement(y.Item,{onClick:()=>S(i.twoLevel,"twoLevel")},i.twoLevel.name),i.threeLevel&&e.createElement(y.Item,{onClick:()=>S(i.threeLevel,"threeLevel")},i.threeLevel.name),i.fourLevel&&e.createElement(y.Item,{onClick:()=>S(i.fourLevel,"fourLevel")},i.fourLevel.name),i.fiveLevel&&e.createElement(y.Item,{onClick:()=>S(i.fiveLevel,"fiveLevel")},i.fiveLevel.name)))};let z;const Se=c=>{let{productState:{paginations:i,category:p,products:n,totalProduct:v,currentCategoryRoot:S,currentCategorySelected:m,filteredAttributes:t,lastSelectedCategory:a,selectedCatSections:f,loadingStates:d,filters:E},appState:{ui_categories:[]}}=c;const C=B(),h=H(),[b,ye]=e.useState({perPage:3,currentPage:1});e.useState({}),e.useState({id:"",isExpand:!1,name:"",sub_menu:{_id:"",id:"",isExpand:!1,name:"",sub_menu:{_id:"",id:"",isExpand:!1,name:""}}}),e.useState({});const[M,U]=e.useState({});e.useEffect(()=>{let{cat:r,cat_tree:o}=Y.parse(C.location.search),l=c.appState.ui_categories?c.appState.ui_categories.find(_=>_.id==r):{},{lastSelectedCategory:s,selectedCatSections:u}=W(l,o);h({type:"SET_SELECTED_CATEGORY_SECTIONS",payload:u}),h({type:"SET_LAST_SELECTED_CATEGORY",payload:s})},[C.location.search]);function W(r,o){let l={},s={oneLevel:r};if(r){if(r.id===o)l=r;else if(r.sub_menu){for(let u=0;u<r.sub_menu.length;u++)if(r.sub_menu[u].id===o)l=r.sub_menu[u],s=x(N({},s),{twoLevel:r.sub_menu[u]});else if(r.sub_menu[u].sub_menu){for(let _=0;_<r.sub_menu[u].sub_menu.length;_++)if(r.sub_menu[u].sub_menu[_].id==o)l=r.sub_menu[u].sub_menu[_],s=x(N({},s),{twoLevel:r.sub_menu[u],threeLevel:r.sub_menu[u].sub_menu[_]});else if(r.sub_menu[u].sub_menu[_].sub_menu)for(let L=0;L<r.sub_menu[u].sub_menu[_].sub_menu.length;L++)r.sub_menu[u].sub_menu[_].sub_menu[L].id===o&&(l=r.sub_menu[u].sub_menu[_].sub_menu[L])}}}return{lastSelectedCategory:l,selectedCatSections:s}}e.useEffect(function(){(async function(){try{if(a){const{sortBy:r,brands:o=[]}=E;if(a._id||a._ids){let l="";a._ids&&a._ids.length>0?a._ids.forEach((s,u)=>{u!==0?l+="+"+s:l+=s}):l=a._id,T({lastSelectedCategory:a,selectedCatSections:f,brands:o,filteredAttributes:t,sortBy:r,paginate:{currentPage:1,perPage:20},count:!1},function(s){h({type:w.FETCH_PRODUCTS,payload:s})})}else a&&a._ids&&T({lastSelectedCategory:a,selectedCatSections:f,brands:o,filteredAttributes:t,sortBy:r,paginate:{currentPage:1,perPage:20},count:!1},function(l){h({type:w.FETCH_PRODUCTS,payload:l})})}}catch(r){console.log("error,,,,,,,,",r)}})()},[a,f]),e.useEffect(()=>{try{const{sortBy:r,brands:o}=E;a&&a._id&&T({brands:o,lastSelectedCategory:a,filteredAttributes:t,selectedCatSections:f,sortBy:r,paginate:{currentPage:1,perPage:20},count:!1},function(l){h({type:w.FETCH_PRODUCTS,payload:l})})}catch(r){console.log("error,,,,,,,,",r)}},[E.brands,t,E.sortBy]),de(()=>{},[i]);async function T(r,o){c.toggleAppMask(!0),c.toggleLoader&&c.toggleLoader("product-filter",!0);const{lastSelectedCategory:l,selectedCatSections:s,brands:u,filteredAttributes:_,sortBy:L,paginate:P,count:Q=!1}=r;let I={};_.length>0&&_.forEach(g=>{let D=[];g.values.forEach(R=>{D.push(R.value)}),I[g.attribute_name]=D});let k=[];u&&u.forEach(g=>{k.push(g._id)});let A={attributes:I,brand_ids:k.length>0?k:[],sort_by:L&&L.length>0?L:[],pageNumber:P&&P.currentPage,perPage:P&&P.perPage,count:Q};l&&l._id&&(A.category_id=l._id),l&&l._ids&&(A.category_ids=l._ids);try{let{data:g}=await G.post("/api/products/filter/v2",A);g&&(c.toggleAppMask(!1),c.toggleLoader("product-filter",!1),o(g))}catch(g){console.log(g)}}function X(){function r(l){G.post("/api/toggle-wishlist",{productId:l._id}).then(s=>{console.log(s)})}let o=["title","price"];return e.createElement("div",{className:"products-views"},n&&n.length>0?n.map(l=>{var s;return e.createElement("div",{className:"product card pb-5"},e.createElement("i",{onClick:()=>r(l),className:["add_wish_list_btn  fa fa-heart","wish"].join(" ")}),e.createElement("div",{className:"add_wish_list_btn left"},e.createElement(se,{color:"light-A400",radius:2,bg:"primary",count:"Best Value"})),e.createElement($,{to:`/products/${l._id}`},e.createElement("div",{className:"product_image_div"},e.createElement("div",{className:"product_image_wra"},e.createElement("img",{src:ce(l.cover_photo),alt:""})))),e.createElement("div",{className:"card-body mx-5 mt-5"},e.createElement(oe,{level:5,className:"product__brand_name"},(s=l==null?void 0:l.brand)==null?void 0:s.name),o.indexOf("title")!==-1&&e.createElement("h4",{className:"product__title"},e.createElement(ue,{theme:"simple-white",tooltip:e.createElement("a",null,l.title)},e.createElement($,{to:`/products/${l._id}`},l.title.slice(0,20),l.title&&l.title.length>20?"...":""))),e.createElement("div",{className:"product__price_row d-flex align-center"},e.createElement("h5",{className:"product__price"},"TK ",fe(l.discount,l.price)),l.discount!==0&&e.createElement("span",{className:"product__price_old ml-3"},"TK",l.price),l.discount!==0&&e.createElement("h5",{className:"product__discount_row"},l.discount,"% off")),o.indexOf("size")!==-1&&e.createElement("div",{className:"product__size_row d-flex align-center"},e.createElement("h4",{className:""},"Size"),e.createElement("span",{className:" ml-5"},"S, M, L, XL, XXL"))))}):e.createElement(pe,{title:"Product not found on this Category "}))}function q(){const r=[{label:"Popularity",field:"views",order:-1,id:1},{label:"Price -- Low to High",field:"price",order:1,id:2},{label:"Price -- High to Low",field:"price",order:-1,id:3},{label:"Newest First",field:"created_at",order:-1,id:4}];async function o(s){let u=[...E.sortBy];u=[{field:s.field,id:s.id,order:s.order}],h({type:w.ADD_FILTER,payload:{sortBy:u}})}function l(s){return E.sortBy.findIndex(_=>_.id===s)!==-1}return r.map(s=>e.createElement("span",{onClick:()=>o(s),key:s.key,className:["inline-nav",l(s.id)?"inline-nav__active":""].join(" ")},s.label))}function K(r){let o=[...i],l=o.findIndex(s=>s.where==="filter_products_page");l!==-1?o[l].currentPage=r:o.push({currentPage:r,where:"filter_products_page",perPage:3}),h({type:"SET_PAGINATIONS",payload:o})}e.useEffect(()=>{Y.parse(C.location.search),U({categoryData:M})},[C.location.search]);function V(r){return z=r,null}function J(r){let o=d.find(l=>l.where===r);return e.createElement("div",{className:""},o&&o.isLoading&&e.createElement(ve,{size:30,loaderColor:"#502cff",borderWidth:4}))}return e.createElement(ie,{maxWidth:1688},e.createElement("div",{className:"spin-fixed top-1/4 "},J("product-filter")),e.createElement("div",{className:"product-filter-page--layout"},e.createElement("div",{className:"sidebar"},z,e.createElement(he,{ui_filterItems:{}}),e.createElement(me,{selectedCatSections:f,lastSelectedCategory:a,cb:V})),e.createElement("div",{className:"content content-container"},e.createElement(Le,{history:C,dispatch:h,selectedCatSections:f}),e.createElement("h4",null,a._id&&a._id),e.createElement("div",{className:"row my-5"},e.createElement("h4",null,m.name,e.createElement("span",{className:"sm-text"},`(Showing 1 \u2013 ${b.perPage*b.currentPage>v?v:b.perPage*b.currentPage} products of ${v} products)`))),e.createElement("div",{className:"row my-5 sorting_btn_section"},"Sort By",q()),X(),e.createElement("div",null,e.createElement(_e,{totalItem:v,perPage:b.perPage,currentPage:b.currentPage,onChange:K})))))};function be(c){return{productState:c.productState,appState:c.appState}}var De=O(be,{toggleLoader:ne,toggleAppMask:re})(Se);export{De as default};
